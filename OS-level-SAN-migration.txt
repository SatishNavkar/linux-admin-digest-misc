
SAN migration (possible vendors involved : EMC NetApp 3PAR)

--- Double-check this plan ---- Try on dummy ---

** Collect all pre-requisites

   vxprint -htg <DG>
   vxconfigbackup -l <mount>   ## check /etc/cbr/vx/bk/
   systool -c fc_host -v | grep -i port

** Scan all new "disks"

   echo "- - -" > /sys/class/scsi_host/hostX/scan
   vxdctl enable; vxdisk scandisks

** Take new "disks" in VxVM control

   vxdisksetup -i <new-disk's> ...

** Add new disks to appropriate DG

   vxdg -g <DG> adddisk <disk-name1>=<new-disk01> <disk-name2>=<new-disk02>

** Mirror old disk with new disk .. to preserve data from disk to be removed ==== need to find exact step here

   vxmirror -bg <DG> volume <VOL> <old-disk01> <new-disk01> ..  --- check syntax ??
   or
   vxmirror -g <DG> -a <new-disk01> <new-disk02> ..
   or
   vxmirror -g <DG> <old-disk01>  <new-disk01>
   or
   vxassist -b -g <DG> mirror <VOL> layout=nostripe alloc=disk01,..2,..3,..
   or
   vxmirror -bg <DG> volume alloc emcx  --- ??

** Monitor mirroring process

   vxtask list

** Break mirror after sync is completed

   vxplex -g <DG> -o rm dis <old-disk01> ..

** Remove disks from DG and remove from VxVM control

   vxdisk rmdisk <old-disk01> ...   ## check .. needs reclaim steps ?
   vxdiskunsetup -c <old-disk01> ..  ## check if really required

** Rescan after disks are removed from storage-end

   echo 1 > /sys/class/fc_host
    or
   echo "- - -" > /sys/class/scsi_host/hostX/scan


===== Additional .. if disk is showing failed .. check if really failed or mark failing flag off

   vxedit -g <DG> set failing=off <disk01>

* Another sample .. setting owner of raw disks .. in case of sybase mostly

   vxedit -g <DG> set user=sybase group=sybase <raw-vol>

* Setting clone flag off or on

   vxdisk set <disk-name> clone=<off/on>
   ++ # vxdisk updateudid <disk-name>
